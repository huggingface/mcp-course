# MCPクライアントの構築

このセクションでは、異なるプログラミング言語を使用してMCPサーバーと相互作用できるクライアントを作成します。HuggingFace.jsを使用したJavaScriptクライアントとsmolagentsを使用したPythonクライアントの両方を実装します。

## MCPクライアントの設定

MCPサーバーとクライアントの効果的なデプロイには適切な設定が必要です。MCP仕様はまだ進化しているため、設定方法は進化する可能性があります。現在の設定のベストプラクティスに焦点を当てます。

### MCP設定ファイル

MCPホストは設定ファイルを使用してサーバー接続を管理します。これらのファイルは、利用可能なサーバーとそれらへの接続方法を定義します。

設定ファイルは非常にシンプルで、理解しやすく、主要なMCPホスト間で一貫しています。

#### `mcp.json`構造

MCPの標準設定ファイルは`mcp.json`という名前です。基本的な構造は以下の通りです：

```json
{
  "servers": [
    {
      "name": "MCP Server",
      "transport": {
        "type": "sse",
        "url": "http://localhost:7860/gradio_api/mcp/sse"
      }
    }
  ]
}
```

この例では、SSEトランスポートを使用し、ポート7860で実行されているローカルGradioサーバーに接続する単一のサーバーが設定されています。

<Tip>

Gradioアプリがリモートサーバーで実行されていると仮定しているため、SSEトランスポート経由でGradioアプリに接続しています。しかし、ローカルスクリプトに接続したい場合は、`sse`トランスポートの代わりに`stdio`トランスポートを使用することがより良い選択肢です。

</Tip>

#### HTTP+SSEトランスポートの設定

HTTP+SSEトランスポートを使用するリモートサーバーの場合、設定にはサーバーURLが含まれます：

```json
{
  "servers": [
    {
      "name": "Remote MCP Server",
      "transport": {
        "type": "sse",
        "url": "https://example.com/gradio_api/mcp/sse"
      }
    }
  ]
}
```

この設定により、UIクライアントはMCPプロトコルを使用してGradio MCPサーバーと通信でき、フロントエンドとMCPサービス間のシームレスな統合を可能にします。

## UI MCPクライアントの設定

Gradio MCPサーバーで作業する場合、MCPプロトコルを使用してサーバーに接続するようにUIクライアントを設定できます。設定方法は以下の通りです：

### 基本設定

以下の設定で`config.json`という新しいファイルを作成してください：

```json
{
  "mcpServers": {
    "mcp": {
      "url": "http://localhost:7860/gradio_api/mcp/sse"
    }
  }
}
```

この設定により、UIクライアントはMCPプロトコルを使用してGradio MCPサーバーと通信でき、フロントエンドとMCPサービス間のシームレスな統合を可能にします。

## Cursor IDE内でのMCPクライアントの設定

Cursorは組み込みMCPサポートを提供し、デプロイされたMCPサーバーを開発環境に直接接続できます。

### 設定

Cursor設定（`Ctrl + Shift + J` / `Cmd + Shift + J`）→ **MCP**タブ→ **Add new global MCP server**を開きます：

**macOS:**
```json
{
  "mcpServers": {
    "sentiment-analysis": {
      "command": "npx",
      "args": [
        "-y", 
        "mcp-remote", 
        "https://YOURUSENAME-mcp-sentiment.hf.space/gradio_api/mcp/sse", 
        "--transport", 
        "sse-only"
      ]
    }
  }
}
```

**Windows:**
```json
{
  "mcpServers": {
    "sentiment-analysis": {
      "command": "cmd",
      "args": [
        "/c", 
        "npx", 
        "-y", 
        "mcp-remote", 
        "https://YOURUSENAME-mcp-sentiment.hf.space/gradio_api/mcp/sse", 
        "--transport", 
        "sse-only"
      ]
    }
  }
}
```

### mcp-remoteを使用する理由

Cursorを含むほとんどのMCPクライアントは、現在stdioトランスポート経由のローカルサーバーのみをサポートしており、OAuth認証を使用するリモートサーバーはまだサポートしていません。`mcp-remote`ツールは以下の機能を提供するブリッジソリューションとして機能します：

- マシン上でローカルに実行
- CursorからリモートMCPサーバーへのリクエストを転送
- 馴染みのある設定ファイル形式を使用

設定完了後、コードコメント、ユーザーフィードバック、プルリクエストの説明の分析などのタスクに、感情分析ツールを使用するようにCursorに求めることができます。

