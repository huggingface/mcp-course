# Integra√ß√£o do Gradio com MCP

Agora que exploramos os conceitos fundamentais do protocolo MCP e como implementar Servidores e Clientes MCP, vamos facilitar um pouco as coisas usando o Gradio para criar um Servidor MCP!

<Tip>

Gradio √© uma biblioteca Python popular para criar rapidamente interfaces web personaliz√°veis para modelos de aprendizado de m√°quina.

</Tip>

## Introdu√ß√£o ao Gradio

O Gradio permite que desenvolvedores criem interfaces de usu√°rio para seus modelos com apenas algumas linhas de c√≥digo Python. √â particularmente √∫til para:

- Criar demonstra√ß√µes e prot√≥tipos
- Compartilhar modelos com usu√°rios n√£o t√©cnicos
- Testar e depurar o comportamento do modelo

Com a adi√ß√£o do suporte ao MCP, o Gradio agora oferece uma maneira direta de expor as capacidades do modelo de IA atrav√©s do protocolo MCP padronizado.

Combinar o Gradio com o MCP permite criar interfaces amig√°veis para humanos e ferramentas acess√≠veis por IA com c√≥digo m√≠nimo. Mas o melhor de tudo √© que o Gradio j√° √© amplamente utilizado pela comunidade de IA, ent√£o voc√™ pode us√°-lo para compartilhar seus Servidores MCP com outras pessoas.

## Pr√©-requisitos

Para usar o Gradio com suporte ao MCP, voc√™ precisar√° instalar o Gradio com o extra MCP:

```bash
pip install "gradio[mcp]"
```

Voc√™ tamb√©m precisar√° de uma aplica√ß√£o LLM que suporte chamada de ferramentas usando o protocolo MCP, como o Cursor (conhecido como "MCP Hosts").

## Criando um Servidor MCP com Gradio

Vamos ver um exemplo b√°sico de como criar um Servidor MCP usando Gradio:

```python
import gradio as gr

def letter_counter(word: str, letter: str) -> int:
    """
    Count the number of occurrences of a letter in a word or text.

    Args:
        word (str): The input text to search through
        letter (str): The letter to search for

    Returns:
        int: The number of times the letter appears in the text
    """
    word = word.lower()
    letter = letter.lower()
    count = word.count(letter)
    return count

# Create a standard Gradio interface
demo = gr.Interface(
    fn=letter_counter,
    inputs=["textbox", "textbox"],
    outputs="number",
    title="Letter Counter",
    description="Enter text and a letter to count how many times the letter appears in the text."
)

# Launch both the Gradio web interface and the MCP server
if __name__ == "__main__":
    demo.launch(mcp_server=True)
```

Com esta configura√ß√£o, sua fun√ß√£o de contador de letras agora est√° acess√≠vel atrav√©s de:

1. Uma interface web tradicional do Gradio para intera√ß√£o humana direta
2. Um Servidor MCP que pode ser conectado a clientes compat√≠veis

O servidor MCP estar√° acess√≠vel em:
```
http://your-server:port/gradio_api/mcp/sse
```

A aplica√ß√£o em si ainda estar√° acess√≠vel e se parece com isto:

![Servidor Gradio MCP](https://huggingface.co/datasets/mcp-course/images/resolve/main/unit1/7.png)

## Como Funciona nos Bastidores

Quando voc√™ define `mcp_server=True` em `launch()`, v√°rias coisas acontecem:

1. As fun√ß√µes do Gradio s√£o automaticamente convertidas em Ferramentas MCP
2. Os componentes de entrada s√£o mapeados para esquemas de argumentos de ferramentas
3. Os componentes de sa√≠da determinam o formato da resposta
4. O servidor Gradio passa a ouvir mensagens do protocolo MCP
5. JSON-RPC sobre HTTP+SSE √© configurado para comunica√ß√£o cliente-servidor

## Principais Caracter√≠sticas da Integra√ß√£o Gradio <> MCP

1. **Convers√£o de Ferramentas**: Cada endpoint da API em seu aplicativo Gradio √© automaticamente convertido em uma ferramenta MCP com nome, descri√ß√£o e esquema de entrada correspondentes. Para visualizar as ferramentas e esquemas, visite `http://your-server:port/gradio_api/mcp/schema` ou acesse o link "View API" no rodap√© do seu aplicativo Gradio, e depois clique em "MCP".

2. **Suporte a Vari√°veis de Ambiente**: Existem duas maneiras de habilitar a funcionalidade do servidor MCP:
- Usando o par√¢metro `mcp_server` em `launch()`:
  ```python
  demo.launch(mcp_server=True)
  ```
- Usando vari√°veis de ambiente:
  ```bash
  export GRADIO_MCP_SERVER=True
  ```

3. **Manipula√ß√£o de Arquivos**: O servidor lida automaticamente com convers√µes de dados de arquivos, incluindo:
   - Convers√£o de strings codificadas em base64 para dados de arquivo
   - Processamento de arquivos de imagem e retorno no formato correto
   - Gerenciamento de armazenamento tempor√°rio de arquivos

   √â **fortemente** recomendado que imagens e arquivos de entrada sejam passados como URLs completas ("http://..." ou "https://..."), pois os Clientes MCP nem sempre lidam corretamente com arquivos locais.

4. **Servidores MCP Hospedados no ü§ó Spaces**: Voc√™ pode publicar seu aplicativo Gradio gratuitamente no Hugging Face Spaces, o que permitir√° ter um servidor MCP hospedado gratuitamente. Aqui est√° um exemplo de Space: https://huggingface.co/spaces/abidlabs/mcp-tools

## Dicas de Solu√ß√£o de Problemas

1. **Dicas de Tipo e Docstrings**: Certifique-se de fornecer dicas de tipo e docstrings v√°lidas para suas fun√ß√µes. A docstring deve incluir um bloco "Args:" com nomes de par√¢metros indentados.

2. **Entradas de String**: Em caso de d√∫vida, aceite argumentos de entrada como `str` e converta-os para o tipo desejado dentro da fun√ß√£o.

3. **Suporte a SSE**: Alguns Hosts MCP n√£o suportam Servidores MCP baseados em SSE. Nesses casos, voc√™ pode usar `mcp-remote`:
   ```json
   {
     "mcpServers": {
       "gradio": {
         "command": "npx",
         "args": [
           "mcp-remote",
           "http://your-server:port/gradio_api/mcp/sse"
         ]
       }
     }
   }
   ```

4. **Reiniciar**: Se encontrar problemas de conex√£o, tente reiniciar tanto seu Cliente MCP quanto seu Servidor MCP.

## Compartilhe seu Servidor MCP

Voc√™ pode compartilhar seu Servidor MCP publicando seu aplicativo Gradio no Hugging Face Spaces. O v√≠deo abaixo mostra como criar um Hugging Face Space.

<Youtube id="3bSVKNKb_PY" />

Agora, voc√™ pode compartilhar seu Servidor MCP com outras pessoas compartilhando seu Hugging Face Space.

## Conclus√£o

A integra√ß√£o do Gradio com o MCP fornece um ponto de entrada acess√≠vel para o ecossistema MCP. Ao aproveitar a simplicidade do Gradio e adicionar a padroniza√ß√£o do MCP, os desenvolvedores podem criar rapidamente interfaces amig√°veis para humanos e ferramentas acess√≠veis por IA com c√≥digo m√≠nimo.

√Ä medida que avan√ßamos neste curso, exploraremos implementa√ß√µes mais sofisticadas do MCP, mas o Gradio oferece um excelente ponto de partida para entender e experimentar o protocolo.

Na pr√≥xima unidade, mergulharemos mais profundamente na constru√ß√£o de aplica√ß√µes MCP, focando na configura√ß√£o de ambientes de desenvolvimento, explorando SDKs e implementando Servidores e Clientes MCP mais avan√ßados.
